<html lang="en">
<head>
<title>Options for Scanner Speed and Size - Lexical Analysis With Flex</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Lexical Analysis With Flex">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Scanner-Options.html#Scanner-Options" title="Scanner Options">
<link rel="prev" href="Code_002dLevel-And-API-Options.html#Code_002dLevel-And-API-Options" title="Code-Level And API Options">
<link rel="next" href="Debugging-Options.html#Debugging-Options" title="Debugging Options">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
The flex manual is placed under the same licensing conditions as the
rest of flex:

Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007 The Flex
Project.

Copyright (C) 1990, 1997 The Regents of the University of California.
All rights reserved.

This code is derived from software contributed to Berkeley by
Vern Paxson.

The United States Government has rights in this work pursuant
to contract no. DE-AC03-76SF00098 between the United States
Department of Energy and the University of California.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
  1.  Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.

  2. Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in the
     documentation and/or other materials provided with the
     distribution.

Neither the name of the University nor the names of its contributors
may be used to endorse or promote products derived from this software
without specific prior written permission.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Options-for-Scanner-Speed-and-Size"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Debugging-Options.html#Debugging-Options">Debugging Options</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Code_002dLevel-And-API-Options.html#Code_002dLevel-And-API-Options">Code-Level And API Options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Scanner-Options.html#Scanner-Options">Scanner Options</a>
<hr>
</div>

<h3 class="section">16.4 Options for Scanner Speed and Size</h3>

     <dl>
<dt>&lsquo;<samp><span class="samp">-C[aefFmr]</span></samp>&rsquo;<dd>controls the degree of table compression and, more generally, trade-offs
between small scanners and fast scanners.

          
<a name="index-g_t_002dC-323"></a>
<dl><dt>&lsquo;<samp><span class="samp">-C</span></samp>&rsquo;<dd>A lone &lsquo;<samp><span class="samp">-C</span></samp>&rsquo; specifies that the scanner tables should be compressed
but neither equivalence classes nor meta-equivalence classes should be
used.

          <p><a name="option_002dalign"></a><a name="index-g_t_002dCa-324"></a><a name="index-g_t_002d_002d_002dalign-325"></a><a name="index-align-326"></a><br><dt>&lsquo;<samp><span class="samp">-Ca, --align, </span><code>%option align</code></samp>&rsquo;<dd>(&ldquo;align&rdquo;) instructs flex to trade off larger tables in the
generated scanner for faster performance because the elements of
the tables are better aligned for memory access and computation.  On some
RISC architectures, fetching and manipulating longwords is more efficient
than with smaller-sized units such as shortwords.  This option can
quadruple the size of the tables used by your scanner.

          <p><a name="option_002decs"></a><a name="index-g_t_002dCe-327"></a><a name="index-g_t_002d_002d_002decs-328"></a><a name="index-ecs-329"></a><br><dt>&lsquo;<samp><span class="samp">-Ce, --ecs, </span><code>%option ecs</code></samp>&rsquo;<dd>directs <code>flex</code> to construct <dfn>equivalence classes</dfn>, i.e., sets
of characters which have identical lexical properties (for example, if
the only appearance of digits in the <code>flex</code> input is in the
character class &ldquo;[0-9]&rdquo; then the digits '0', '1', ..., '9' will all be
put in the same equivalence class).  Equivalence classes usually give
dramatic reductions in the final table/object file sizes (typically a
factor of 2-5) and are pretty cheap performance-wise (one array look-up
per character scanned).

          <p><a name="index-g_t_002dCf-330"></a><br><dt>&lsquo;<samp><span class="samp">-Cf</span></samp>&rsquo;<dd>specifies that the <dfn>full</dfn> scanner tables should be generated -
<code>flex</code> should not compress the tables by taking advantages of
similar transition functions for different states.

          <p><a name="index-g_t_002dCF-331"></a><br><dt>&lsquo;<samp><span class="samp">-CF</span></samp>&rsquo;<dd>specifies that the alternate fast scanner representation (described
above under the &lsquo;<samp><span class="samp">--fast</span></samp>&rsquo; flag) should be used.  This option cannot be
used with &lsquo;<samp><span class="samp">--c++</span></samp>&rsquo;.

          <p><a name="option_002dmeta_002decs"></a><a name="index-g_t_002dCm-332"></a><a name="index-g_t_002d_002d_002dmeta_002decs-333"></a><a name="index-meta_002decs-334"></a><br><dt>&lsquo;<samp><span class="samp">-Cm, --meta-ecs, </span><code>%option meta-ecs</code></samp>&rsquo;<dd>directs
<code>flex</code>
to construct
<dfn>meta-equivalence classes</dfn>,
which are sets of equivalence classes (or characters, if equivalence
classes are not being used) that are commonly used together.  Meta-equivalence
classes are often a big win when using compressed tables, but they
have a moderate performance impact (one or two <code>if</code> tests and one
array look-up per character scanned).

          <p><a name="option_002dread"></a><a name="index-g_t_002dCr-335"></a><a name="index-g_t_002d_002d_002dread-336"></a><a name="index-read-337"></a><br><dt>&lsquo;<samp><span class="samp">-Cr, --read, </span><code>%option read</code></samp>&rsquo;<dd>causes the generated scanner to <em>bypass</em> use of the standard I/O
library (<code>stdio</code>) for input.  Instead of calling <code>fread()</code> or
<code>getc()</code>, the scanner will use the <code>read()</code> system call,
resulting in a performance gain which varies from system to system, but
in general is probably negligible unless you are also using &lsquo;<samp><span class="samp">-Cf</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">-CF</span></samp>&rsquo;.  Using &lsquo;<samp><span class="samp">-Cr</span></samp>&rsquo; can cause strange behavior if, for
example, you read from <samp><span class="file">yyin</span></samp> using <code>stdio</code> prior to calling
the scanner (because the scanner will miss whatever text your previous
reads left in the <code>stdio</code> input buffer).  &lsquo;<samp><span class="samp">-Cr</span></samp>&rsquo; has no effect
if you define <code>YY_INPUT()</code> (see <a href="Generated-Scanner.html#Generated-Scanner">Generated Scanner</a>). 
</dl>

     <p>The options &lsquo;<samp><span class="samp">-Cf</span></samp>&rsquo; or &lsquo;<samp><span class="samp">-CF</span></samp>&rsquo; and &lsquo;<samp><span class="samp">-Cm</span></samp>&rsquo; do not make sense
together - there is no opportunity for meta-equivalence classes if the
table is not being compressed.  Otherwise the options may be freely
mixed, and are cumulative.

     <p>The default setting is &lsquo;<samp><span class="samp">-Cem</span></samp>&rsquo;, which specifies that <code>flex</code>
should generate equivalence classes and meta-equivalence classes.  This
setting provides the highest degree of table compression.  You can trade
off faster-executing scanners at the cost of larger tables with the
following generally being true:

     <pre class="example">     <pre class="verbatim">              slowest &amp; smallest
                    -Cem
                    -Cm
                    -Ce
                    -C
                    -C{f,F}e
                    -C{f,F}
                    -C{f,F}a
              fastest &amp; largest
     </pre>
</pre>
     <p>Note that scanners with the smallest tables are usually generated and
compiled the quickest, so during development you will usually want to
use the default, maximal compression.

     <p>&lsquo;<samp><span class="samp">-Cfe</span></samp>&rsquo; is often a good compromise between speed and size for
production scanners.

     <p><a name="option_002dfull"></a><a name="index-g_t_002df-338"></a><a name="index-g_t_002d_002d_002dfull-339"></a><a name="index-full-340"></a><br><dt>&lsquo;<samp><span class="samp">-f, --full, </span><code>%option full</code></samp>&rsquo;<dd>specifies
<dfn>fast scanner</dfn>. 
No table compression is done and <code>stdio</code> is bypassed. 
The result is large but fast.  This option is equivalent to
&lsquo;<samp><span class="samp">--Cfr</span></samp>&rsquo;

     <p><a name="option_002dfast"></a><a name="index-g_t_002dF-341"></a><a name="index-g_t_002d_002d_002dfast-342"></a><a name="index-fast-343"></a><br><dt>&lsquo;<samp><span class="samp">-F, --fast, </span><code>%option fast</code></samp>&rsquo;<dd>specifies that the <em>fast</em> scanner table representation should be
used (and <code>stdio</code> bypassed).  This representation is about as fast
as the full table representation &lsquo;<samp><span class="samp">--full</span></samp>&rsquo;, and for some sets of
patterns will be considerably smaller (and for others, larger).  In
general, if the pattern set contains both <em>keywords</em> and a
catch-all, <em>identifier</em> rule, such as in the set:

     <pre class="example">     <pre class="verbatim">              "case"    return TOK_CASE;
              "switch"  return TOK_SWITCH;
              ...
              "default" return TOK_DEFAULT;
              [a-z]+    return TOK_ID;
     </pre>
</pre>
     <p>then you're better off using the full table representation.  If only
the <em>identifier</em> rule is present and you then use a hash table or some such
to detect the keywords, you're better off using
&lsquo;<samp><span class="samp">--fast</span></samp>&rsquo;.

     <p>This option is equivalent to &lsquo;<samp><span class="samp">-CFr</span></samp>&rsquo;.  It cannot be used
with &lsquo;<samp><span class="samp">--c++</span></samp>&rsquo;.

</dl>

   </body></html>

